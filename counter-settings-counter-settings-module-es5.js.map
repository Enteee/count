{"version":3,"sources":["webpack:///src/app/counter-detail/counter-settings/counter-settings.module.ts","webpack:///src/app/counter-detail/counter-settings/counter-settings.page.html","webpack:///src/app/counter-detail/counter-settings/counter-settings.page.ts","webpack:///src/app/guards/unsaved-changes/unsaved-changes.guard.ts","webpack:///src/app/services/counter.service.ts"],"names":["routes","path","component","canDeactivate","CounterSettingsPageModule","forChild","imports","declarations","CounterSettingsPage","router","route","counterRepositoryService","counterService","appStateService","counter","snapshot","data","appState","positiveLimit","min","positiveLimitActive","negativeLimit","negativeLimitActive","counterSettingsForm","title","plusCount","minusCount","vibrate","locked","focusTitle","paramMap","get","setTimeout","titleElement","setFocus","patchValue","valid","value","save","Object","assign","formControlName","clampValue","clampFunction","Math","submit","increment","clamp","selector","templateUrl","styleUrls","UnsavedChangesGuard","alertController","state","hasUnsavedChanges","canDiscard","Promise","resolve","reject","create","header","message","buttons","text","handler","_","alert","present","providedIn","CounterService","countEventRepositoryService","positionService","vibration","newCounter","sortOrder","all","length","getByCounter","map","i","delta","count","VIBRATION_PATTERN_POSITIVE","VIBRATION_PATTERN_NEGATIVE","position","getPosition","setRecordPosition","id","Reset","setLocked","from","to","counters","allSortBySortOrder","splice","randomDate","start","end","Date","getTime","random","round","Change"],"mappings":"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","file":"counter-settings-counter-settings-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NotImplementedModule } from '../../not-implemented/not-implemented.module';\n\nimport { UnsavedChangesGuard } from '../../guards/unsaved-changes/unsaved-changes.guard';\n\n\nimport { CounterSettingsPage } from './counter-settings.page';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CounterSettingsPage,\n    canDeactivate: [\n      UnsavedChangesGuard,\n    ],\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    NotImplementedModule,\n  ],\n  declarations: [CounterSettingsPage]\n})\nexport class CounterSettingsPageModule {}\n","<ion-content>\n  <form\n    [formGroup]=\"counterSettingsForm\"\n    (ngSubmit)=\"submit()\"\n    (ionChange)=\"submit()\"\n  >\n      <ion-list>\n        <ion-item-group>\n\n          <ion-item>\n            <ion-label position=\"stacked\">Title</ion-label>\n\n            <ion-input\n              required\n              formControlName=\"title\"\n              type=\"text\"\n              placeholder=\"my Counter\"\n              class=\"title-input\"\n              #titleInput\n            ></ion-input>\n          </ion-item>\n\n          <ion-item\n            [hidden]=\"!appState.vibrate\"\n            class=\"vibrate-checkbox\"\n          >\n            <ion-icon slot=\"start\" name=\"pulse-outline\"></ion-icon>\n            <ion-label>Vibrate</ion-label>\n            <ion-checkbox\n              slot=\"end\"\n              formControlName=\"vibrate\"\n            >\n            </ion-checkbox>\n          </ion-item>\n\n          <ion-item>\n            <ion-icon\n              slot=\"start\"\n              name=\"{{ (counter.locked) ? 'lock-closed-outline' : 'lock-open-outline' }}\"\n            ></ion-icon>\n            <ion-label>Locked</ion-label>\n            <ion-checkbox\n              slot=\"end\"\n              formControlName=\"locked\"\n            >\n            </ion-checkbox>\n          </ion-item>\n\n          <ion-item>\n            <ion-icon\n              slot=\"start\"\n              name=\"phone-portrait-outline\"\n            ></ion-icon>\n            <ion-label>Add to Home Screen</ion-label>\n            <ion-checkbox\n              slot=\"end\"\n              appNotImplemented description=\"Add counter widget to home screen\" issueId=\"2\" on=\"click\"\n            >\n            </ion-checkbox>\n          </ion-item>\n        </ion-item-group>\n\n        <ion-item-divider\n            color=\"success\"\n        >\n          <ion-icon\n            name=\"add-circle-outline\"\n          ></ion-icon>\n        </ion-item-divider>\n\n        <ion-item-group>\n\n          <ion-item>\n\n            <ion-icon\n              slot=\"start\"\n              name=\"add\"\n              (click)=\"increment('plusCount')\"\n            ></ion-icon>\n\n            <ion-input\n              required\n              formControlName=\"plusCount\"\n              type=\"number\"\n              placeholder=\"0\"\n              (ionChange)=\"clamp('plusCount')\"\n            >\n            </ion-input>\n\n          </ion-item>\n\n          <ion-item>\n\n            <ion-icon\n              slot=\"start\"\n              name=\"code-download-outline\"\n              class=\"rotate-180\"\n            ></ion-icon>\n\n            <ion-label>Limit</ion-label>\n\n            <ion-checkbox\n              slot=\"end\"\n              formControlName=\"positiveLimitActive\"\n            >\n            </ion-checkbox>\n\n          </ion-item>\n\n          <ng-template [ngIf]=\"this.counter.positiveLimitActive\">\n              <ion-item>\n\n                <ion-icon\n                  slot=\"start\"\n                  name=\"add\"\n                  (click)=\"increment('positiveLimit')\"\n                >\n                </ion-icon>\n\n                <ion-input\n                  required\n                  formControlName=\"positiveLimit\"\n                  type=\"number\"\n                  placeholder=\"0\"\n                  (ionChange)=\"\n                    clamp('positiveLimit', 1);\n                    check('positiveLimitActive');\n                  \"\n                >\n                </ion-input>\n\n              </ion-item>\n          </ng-template>\n        </ion-item-group>\n\n        <ion-item-divider\n            color=\"danger\"\n        >\n          <ion-icon\n            name=\"remove-circle-outline\"\n          ></ion-icon>\n        </ion-item-divider>\n\n        <ion-item-group>\n\n          <ion-item>\n\n            <ion-icon\n              slot=\"start\"\n              name=\"remove\"\n              (click)=\"increment('minusCount')\"\n            ></ion-icon>\n\n            <ion-input\n              required\n              formControlName=\"minusCount\"\n              type=\"number\"\n              placeholder=\"0\"\n              (ionChange)=\"clamp('minusCount')\"\n            >\n            </ion-input>\n          </ion-item>\n\n          <ion-item>\n\n            <ion-icon\n              slot=\"start\"\n              name=\"code-download-outline\"\n            ></ion-icon>\n\n            <ion-label>Limit</ion-label>\n\n            <ion-checkbox\n              slot=\"end\"\n              formControlName=\"negativeLimitActive\"\n            >\n            </ion-checkbox>\n\n          </ion-item>\n\n          <ng-template [ngIf]=\"this.counter.negativeLimitActive\">\n            <ion-item>\n\n              <ion-icon\n                slot=\"start\"\n                name=\"remove\"\n                (click)=\"increment('negativeLimit')\"\n              >\n              </ion-icon>\n\n              <ion-input\n                required\n                formControlName=\"negativeLimit\"\n                type=\"number\"\n                placeholder=\"0\"\n                (ionChange)=\"\n                  clamp('negativeLimit', 1);\n                  check('negativeLimitActive');\n                \"\n              >\n              </ion-input>\n\n            </ion-item>\n          </ng-template>\n        </ion-item-group>\n\n      </ion-list>\n\n  </form>\n</ion-content>\n","import { Component, OnInit, AfterViewInit, ViewChild, ElementRef } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\n\nimport { HasUnsavedChanges } from '../../guards/unsaved-changes/unsaved-changes.guard';\n\nimport { Counter } from '../../models/counter';\nimport { CounterRepositoryService } from '../../models/counter-repository.service';\nimport { CounterService } from '../../services/counter.service';\n\nimport { AppState } from '../../models/app-state';\nimport { AppStateService } from '../../services/app-state.service';\n\ntype ClampFunction = 'max' | 'min';\n\n@Component({\n  selector: 'app-counter-settings',\n  templateUrl: './counter-settings.page.html',\n  styleUrls: ['./counter-settings.page.scss'],\n})\nexport class CounterSettingsPage implements OnInit, AfterViewInit, HasUnsavedChanges {\n\n  counter: Counter;\n  appState: AppState;\n  counterSettingsForm: FormGroup;\n  @ViewChild('titleInput', {static: true}) titleElement;\n\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private counterRepositoryService: CounterRepositoryService,\n    private counterService: CounterService,\n    private appStateService: AppStateService,\n  ) {}\n\n  ngOnInit() {\n    this.counter = this.route.snapshot.data.counter;\n    this.appState = this.appStateService.appState;\n\n    // enable disable input boxed based on checkbox\n    // TODO: this should become a component\n    const positiveLimit = new FormControl(\n      this.counter.positiveLimit,\n      [\n        Validators.min(1)\n      ]\n    );\n    const positiveLimitActive = new FormControl(\n      this.counter.positiveLimitActive,\n      [\n      ]\n    );\n    const negativeLimit = new FormControl(\n      -this.counter.negativeLimit,\n      [\n        Validators.min(1)\n      ]\n    );\n    const negativeLimitActive = new FormControl(\n      this.counter.negativeLimitActive,\n      [\n      ]\n    );\n\n    this.counterSettingsForm = new FormGroup({\n      title : new FormControl(\n        this.counter.title,\n        [\n        ]\n      ),\n      plusCount : new FormControl(\n        this.counter.plusCount,\n        [\n          Validators.min(0)\n        ]\n      ),\n      minusCount : new FormControl(\n        -this.counter.minusCount,\n        [\n          Validators.min(0)\n        ]\n      ),\n      positiveLimit,\n      positiveLimitActive,\n      negativeLimit,\n      negativeLimitActive,\n      vibrate : new FormControl(\n        this.counter.vibrate,\n      ),\n      locked : new FormControl(\n        this.counter.locked,\n      ),\n    });\n\n  }\n\n  async ngAfterViewInit() {\n    const focusTitle = this.route.snapshot.paramMap.get('focusTitle');\n    if (focusTitle) {\n      /*\n       * TODO: Wohaaa this is ugly, but seems to be the only working solution..\n       * cmon angular, implement this focus on element ref thing already!\n       *\n       * Discussion on ionic discourse:\n       * https://forum.ionicframework.com/t/setting-focus-to-an-input-in-ionic/62789/56\n       * Angular pull request:\n       * https://github.com/angular/angular/issues/31133\n       */\n      setTimeout(async () => {\n        await this.titleElement.setFocus();\n        this.counterSettingsForm.patchValue({\n          title: '',\n        });\n      }, 200);\n    }\n  }\n\n  async submit() {\n\n    // only submit if valid\n    if (!this.counterSettingsForm.valid) {\n      return;\n    }\n\n    this.counterSettingsForm.value.minusCount = -this.counterSettingsForm.value.minusCount;\n    this.counterSettingsForm.value.negativeLimit = -this.counterSettingsForm.value.negativeLimit;\n\n    await this.counterRepositoryService.save(\n      Object.assign(\n        this.counter,\n        this.counterSettingsForm.value\n      )\n    );\n  }\n\n  hasUnsavedChanges(): boolean {\n    return !this.counterSettingsForm.valid;\n  }\n\n  check(\n    formControlName: string,\n  ) {\n    this.counterSettingsForm.patchValue({\n      [formControlName]: true,\n    });\n  }\n\n  increment(\n    formControlName: string,\n  ) {\n    let value = this.counterSettingsForm.get(formControlName).value;\n    if (value === null) {\n      value = -1;\n    }\n    this.counterSettingsForm.patchValue({\n      [formControlName]: value + 1,\n    });\n  }\n\n\n  clamp(\n    formControlName: string,\n    clampValue: number = 0,\n    clampFunction = ('max' as ClampFunction),\n  ) {\n    const value = this.counterSettingsForm.get(formControlName).value;\n    if (value !== null) {\n      this.counterSettingsForm.patchValue({\n        [formControlName]: Math[clampFunction](clampValue, value)\n      });\n    }\n  }\n\n}\n\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree, CanDeactivate } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\nimport { Observable } from 'rxjs';\n\nexport interface HasUnsavedChanges {\n  hasUnsavedChanges: () => Observable<boolean> | Promise<boolean> | boolean;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UnsavedChangesGuard implements CanDeactivate<HasUnsavedChanges> {\n  constructor(public alertController: AlertController) {}\n\n  async canDeactivate(component: HasUnsavedChanges,\n                      route: ActivatedRouteSnapshot,\n                      state: RouterStateSnapshot) {\n\n    if (!component.hasUnsavedChanges()) {\n      return true;\n    }\n\n    return await this.canDiscard();\n  }\n\n  /**\n   * Ask the user if they want to discard unsaved changes\n   */\n  canDiscard(): Promise<boolean> {\n    return new Promise(async (resolve, reject) => {\n      const alert = await this.alertController.create({\n          header: 'Unsaved Changes',\n          message: 'You are trying to leave a page which has unsaved changes',\n          buttons: [\n            {\n              text: 'Leave',\n              handler: _ => resolve(true)\n            },\n            {\n              text: 'Stay',\n              handler: _ => resolve(false)\n            }\n          ],\n      });\n      await alert.present();\n    });\n  }\n\n}\n\n","import { Injectable } from '@angular/core';\n\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { Vibration } from '@ionic-native/vibration/ngx';\n\nimport { Counter } from '../models/counter';\nimport { CounterRepositoryService } from '../models/counter-repository.service';\n\nimport { CountEvent, CountEventType } from '../models/count-event';\nimport { CountEventRepositoryService } from '../models/count-event-repository.service';\n\nimport { Position } from '../models/count-event';\nimport { PositionService } from './position.service';\n\nimport { AppStateService } from './app-state.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CounterService {\n\n  static readonly VIBRATION_PATTERN_POSITIVE = [30];\n  static readonly VIBRATION_PATTERN_NEGATIVE = [30, 30, 30];\n\n  constructor(\n    private counterRepositoryService: CounterRepositoryService,\n    private countEventRepositoryService: CountEventRepositoryService,\n    private positionService: PositionService,\n    private appStateService: AppStateService,\n    private vibration: Vibration,\n  ) {}\n\n  get allSortBySortOrder(): Array<Counter> {\n    return this.counterRepositoryService.allSortBySortOrder;\n  }\n\n  async addCounter() {\n    const newCounter = new Counter();\n    // add counter to bottom\n    newCounter.sortOrder = this.counterRepositoryService.all.length + 1;\n    await this.counterRepositoryService.save(newCounter);\n    return newCounter;\n  }\n\n  async delete(counter: Counter) {\n    // first delete the counter: this is so that the ui element disappers\n    // quicker which should be create better user experience.\n    await this.counterRepositoryService.delete(counter);\n\n    // then, delete all events of this counter\n    await Promise.all(\n      this.countEventRepositoryService.getByCounter(counter).map(\n        (i) => this.countEventRepositoryService.delete(i)\n      )\n    );\n  }\n\n  async count(\n    counter: Counter,\n    delta: number,\n  ) {\n    counter.count += delta;\n\n    // vibrate\n    if (\n      this.appStateService.appState.vibrate\n      && counter.vibrate\n    ) {\n      this.vibration.vibrate(\n        (delta > 0) ?\n          CounterService.VIBRATION_PATTERN_POSITIVE :\n          CounterService.VIBRATION_PATTERN_NEGATIVE\n      );\n    }\n\n    // apply positive and negative wraparounds\n    if (\n      counter.positiveLimitActive\n      && counter.count > counter.positiveLimit\n    ) {\n      counter.count = counter.count % counter.positiveLimit;\n    }\n\n    if (\n      counter.negativeLimitActive\n      && counter.count < counter.negativeLimit\n    ) {\n      counter.count = counter.count % counter.negativeLimit;\n    }\n\n    let position = null;\n    try {\n      position = await this.positionService.getPosition();\n    } catch (e) {\n      // user does not allow posiiton recording or something unexpected happened\n      await this.appStateService.setRecordPosition(false);\n    }\n\n    await Promise.all([\n      this.counterRepositoryService.save(counter),\n      this.countEventRepositoryService.save(\n        new CountEvent(\n          counter.id,\n          delta,\n          position,\n        )\n      )\n    ]);\n  }\n\n  async reset(\n    counter: Counter,\n  ) {\n    counter.count = 0;\n    await Promise.all([\n      this.counterRepositoryService.save(\n        counter\n      ),\n      this.countEventRepositoryService.save(\n        new CountEvent(\n          counter.id,\n          0,\n          {} as any,\n          CountEventType.Reset,\n        )\n      ),\n    ]);\n  }\n\n  async setLocked(\n    counter: Counter,\n    setLocked: boolean,\n  ) {\n    counter.locked = setLocked;\n    await this.counterRepositoryService.save(\n      counter\n    );\n  }\n\n  async reorder(\n    from: number,\n    to: number,\n  ) {\n    const counters = this.counterRepositoryService.allSortBySortOrder;\n    // move element in array\n    counters.splice(to, 0,\n      counters.splice(from, 1)[0]\n    );\n    // save in new order\n    await Promise.all(\n      counters.map(\n        async (counter, i) => {\n          counter.sortOrder = i;\n          await this.counterRepositoryService.save(counter);\n        }\n      )\n    );\n  }\n\n  /**\n   * For development purposes only\n   */\n  async addRandomCountEvent(\n    counter: Counter,\n  ) {\n    const delta = Math.round(Math.random() * 10 % 10 - 5);\n    counter.count += delta;\n\n    function randomDate(start, end) {\n      return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));\n    }\n\n\n    await Promise.all([\n      this.counterRepositoryService.save(counter),\n      this.countEventRepositoryService.save(\n        new CountEvent(\n          counter.id,\n          delta,\n          null,\n          CountEventType.Change,\n          randomDate(new Date(2012, 0, 1), new Date()),\n        )\n      )\n    ]);\n  }\n\n}\n"]}